# Java
## Garbage Collector

### 가비지 컬렉션은 어떤 원리로 소멸시킬 대상을 선정하는가?
- 가비지 컬렉터는 힙 내의 객체 중에서 가비지(참조되고 있지 않은 객체)를 찾아내고 찾아낸 가비지를 처리해서 힙의 메모리를 회수한다.
- 객체가 가비지인지 아닌지를 판단하기 위해 reachability라는 개념을 사용한다.
    - 어떤 힙 영역에 할단된 객체가 유효한 참조가 있으면 reachability 없다면 unreachability로 판단한다.
- 하나의 객체는 다른 객체를 참조하고, 다른 객체는 또 다른 객체를 참조할 수 있기 때문에 참조 사슬이 형성되는데, 이 참조 사슬 중 최초에 참조한 것을 root set이라 칭한다.
- 힙 영역에 있는 객체들은 총 4가지 경우에 대한 참조를 하게 된다.
1. 힙 내에 다른 객체에 의한 참조
2. java 스택, 즉 java 메서드 실행시에 사용하는 지역변수와 파라미터들에 의한 참조
3. 네이티브 스택에 의해 생성된 객체에 대한 참조
4. 메서드 영역의 정적 변수에 의한 참조

**2,3,4는 root set이다.**

### GC과정

![](https://i.imgur.com/I5j0JPu.png)

#### Minor GC
- 새로 생성된 대부분의 객체는 Eden 영역에 위치한다. Eden 영역에서 GC가 한번 발생 후 살아남은 객체는 Survivor 영역 중 하나로 이동된다.
- 이 과정을 반복하다가 계속해서 살아남아 있는 객체는 일정시간 참조되고 있다는 뜻이므로 old 영역으로 이동한다.

#### Major GC
- old 영역에 있는 모든 객체들을 검사하여 참조되지 않은 객체들을 한꺼번에 삭제한다.
- 시간이 오래 걸리고 실행 중 프로세스가 정지된다.(stop the world)
- major gc가 발생하면 gc를 실행하는 스레드를 제외한 나머지 스레드는 모두 작업을 멈춘다.
- GC 작업을 완료한 이후에야 중단했던 작업을 다시 시작한다.

![](https://i.imgur.com/L3s6SfI.png)


## JVM

