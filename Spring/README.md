# Spring

## spring이 생겨나게 된 이유?
EJB -> MVC -> spring MVC
우선 EJB의 경우 view에 data 접근하는 코드, 비지니스 로직등이 분리되지 않고 합쳐져있었다.
또한 파편화로 인해 개발자가 여러 방식을 이해하는데 많은 시간이 걸렸다.
따라서 비지니스 로직에 집중하기 어려웠다.
그로 인해 MVC가 나오게 되었는데 controller는 XML에 구현해야하는 등의 불편함이 있었고, 또한 점점 시대가 변화되면서 비지니스 로직이 거대해졌는데 이를 커버할 수 없게 되었다.
따라서 스프링이 나오게 되었고 스프링은 제어의 주체자로써 개발자가 설정해놓은 파일을 통해 의존성을 주입하고 객체의 생명주기를 제어한다. 
즉, 개발자가 비지니스 로직에 집중할 수 있게 되었다.
## DI & IOC란?
### IOC
- 일반적인 제어권의 흐름이 바뀌었다고 하여 IOC라 한다.
- 객체에 대한 제어권이 개발자로부터 컨테이너에게 넘어가면서 객체의 생성부터 생명주기 관리까지 모든 것을 컨테이너가 맡아서 하게 된다.
### DI
- 오브젝트 사이의 의존관계를 컨테이너가 주입해준다.
### DI & IOC가 어떻게 이루어지는가?
- @autowired 어노테이션을 추가한다.
- 자바 소스 코드가 컴파일 되면 annotation processor라는 컴파일러 플러그인이 annotation을 처리할 수 있다.
-  이 processor는 정보 메세지를 생성하거나 java 소스 파일이나 리소스를 추가로 생성한다.
-  생성된 자바 파일은 javac에 의해 컴파일 될 것이다.

## 싱글톤 패턴을 채택한 이유
- 스프링의 가장 큰 특징은 싱글톤 패턴이라는 점이다.
- Java 서버환경때문에 이 패턴을 채택했다.
- 엔터프라이즈 시스템은 서버 하나당 최대 초당 수십~수백건의 request를 처리해야한다.
- Gc의 성능이 아무리 좋다 한들 한계가 있다. 그래서 인스턴스 한개를 만들어서 공유하는 것이다.
- 스프링은 직접 싱글톤 형태의 오브젝트를 만들고 관리하는 기능을 제공하는 싱글톤 레지스터리가 있다. 그것은 어플리케이션 컨텍스트인데 이는 ioc 컨테이너이기도 하다.
- 자바 싱글톤은 클래스로더에 의해 구현되고, 스프링의 싱글 톤은 스프링 컨테이너에 의해 구현된다.
- 자바 싱글톤의 scope는 코드 전체이고, 스프링 싱글톤의 scope는 해당 컨테이너 내부이다.
- 스프링에 의해 구현되는 싱글톤패턴은 Thread safety를 자동으로 보장한다. 자바로 구현하는 싱글톤패턴은 개발자의 로직에 따라 thread safety를 보장할수도, 보장하지 않을수도 있다.
## AOP
![](https://i.imgur.com/LDVYBf1.png)
- AOP는 웹 개발을 하다보면 로그인관련 처리, xss 방어 등 공통적으로 처리해야할 업무들이 많다.
- 기존 oop의 중복 코드 단점을 해결하고자 나온 방식이다.
- 실행할 때 비즈니스 코드에 앞, 뒤 등 원하는 때에 공통 작업을 수행할 수 있게 하여 중복 코드를 줄인다.

## Application Context란?
![image](https://user-images.githubusercontent.com/25525648/116488616-c3b34580-a8cd-11eb-84cb-eaf6b29955b9.png)
- Web Application 최상단에 위치하고 있는 Context
- Spring에서 ApplicationContext란 BeanFactory를 상속받고 있는 Context
- Spring에서 생성되는 Bean에 대한 IoC Container (또는 Bean Container)
- 빈 설정정보를 토대로 빈을 생성하고 관리한다.
- Bean 객체를 생성하고 관리하는 기능

## @controller을 붙인 클래스에서 @RequestMapping을 통해 url과 매핑되고, view를 리턴함으로써 url에 가게되면 해당 view가 보여지는데 내부 구조
- ViewResolver가 하는 역할
- 다만 스프링 부트에서는 스프링 프레임워크보다 내부적으로 더 깊이 감춰져 있기 때문에 설정을 조정할 일은 없음.
- 만약 컨트롤러에서 “account/createForm”이라는 문자열을 받으면, “src/resources/templates/“를 앞에 “.html”을 뒤에 붙여서 물리적 위치의 파일을 지정
- 이 과정이 ViewResolver가 해주는 역할

