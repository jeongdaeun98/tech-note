# Kafka streams
### 왜 kafka streams 사용했는지? 장단점은?
 기존의 마이크로 배치는 사용자에게 실시간으로 처리 결과를 보여주는 것에 한계가 있었다. 따라서 kafka streams를 통해 실시간으로 스트림 데이터에 대해 가공함으로써 사용자에게 빠른 처리 결과를 보여줄 수 있게 되었다. 또한 흘러가는 시간에 대해 timewindow만큼에 해당하는 데이터들을 집계할 수도 있다. 
### kafka streams는 그렇다면 어디를 저장공간으로 하여 운영되는가?
 이 것을 KTable이라고 하는데 KTable은 rocks DB와 같은 로컬 스토리지에 데이터를 저장공간으로 사용한다.
### 그럼 kafka streams는 어떻게 동작하는가?
컨슈머 그룹내에서 각각의 컨슈머가 각각의 파티션으로부터 데이터를 컨슘하는 거처럼 카프카 스트림즈도 역시 병렬로 데이터 스트림을 처리할 수 있다.
카프카 스트림즈는 일반적인 분산시스템에서 장애 감지, 처리 노드간 조율, 파티션 할당 등을 수행하기 위해 존재하는 마스터라는 개념이 없다. 대신 Kafka의 자체 조율 메커니즘에 전적으로 의존합니다. 이는 곧 작업 노드 간의 통신이 필요 없다는 뜻입니다.
주어진 applicationId로 새 KafkaStreams 인스턴스를 실행하면 해당 applicationId에 대한 consumer 중 하나로 Kafka broker를 구독합니다.
파티션 할당들이 재조정되거나 failover가 발생하면 Kafka 브로커가 스스로 이를 감지하고 처리하기 때문에 작업 노드들이 이를 위해 통신할 필요가 없어집니다.

## 그럼 kafka streams는 더 많은 처리를 하기 위해 어떻게 확장하는가?
카프카 스트림즈는 api입니다. 따라서 카프카 스트림즈를 실행하는 인스턴스를 추가하거나 스레드를 늘리면 됩니다. 그러나 카프카 브로커의 파티션 당 하나의 컨슈머만이 매핑될 수있는 것처럼 카프카 스트림즈 또한 그렇습니다. 따라서 만일 파티션이 10개인 경우 카프카 스트림즈를 실행하는 인스턴스의 개수 또한 10개로 만들면 됩니다.