# 브로커의 역할 - 컨슈머 오프셋 저장, 코디네이터

- 컨슈머 오프셋 저장
    - 컨슈머가 특정 파티션으로부터 데이터를 가져가서 처리하고, 해당 파티션의 어느 레코드까지 가져갔는지 확인하기 위해 오프셋을 커밋.
    - 커밋한 오프셋은 __consumer_offsets 토픽에 저장한다. → 장애 발생 시 브로커를 재실행 해야할 때 해당 토픽에 저장된 오프셋을 바탕으로 함.
    - 여기에 저장된 오프셋을 토대로 컨슈머 그룹은 다음 레코드를 가져가서 처리한다.
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e3302aa2-30c4-43d4-a8f7-141ec50f5196/Untitled.png)
    

- 그룹 코디네이터
    - 컨슈머 그룹의 상태를 체크, 컨슈머와 매칭되도록 분배
    - 컨슈머가 컨슈머 그룹에서 빠지면 매칭되지 않은 파티션을 정상 동작하는 컨슈머로 할당하여 데이터가 처리되도록 도와준다.
    - 파티션을 컨슈머로 재할당하는 과정 - 리밸런스